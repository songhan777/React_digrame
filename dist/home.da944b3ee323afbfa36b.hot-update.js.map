{"version":3,"sources":["webpack:///./src/component/Upload.js"],"names":["box","height","styles","root","position","zIndex","top","left","right","bottom","background","display","justifyContent","alignItems","rootBox","flexDirection","width","opacity","backgroundColor","shutDown","cursor","media","mediaBox","border","row","margin","buttonBox","lineHeight","cancel","color","borderRadius","marginLeft","upload","UploadFile","state","name","path","preview","data","time","setBox","props","change","changeName","e","setState","target","value","changePath","file","files","date","lastModifiedDate","toString","split","src","type","test","URL","createObjectURL","self","reader","FileReader","readAsText","onload","result","console","log","month","toLocaleUpperCase","LocalUpload","id","then","alert","addData","classes","PureComponent"],"mappings":"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","file":"home.da944b3ee323afbfa36b.hot-update.js","sourcesContent":["import React, {PureComponent} from 'react'\r\n\r\nconst box = {\r\n    height: \"100%\",\r\n};\r\n\r\nconst styles = theme => ({\r\n    root: {\r\n        position: \"fixed\",\r\n        zIndex: 1,\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        background: \"rgba(0,0,0,0.5)\",\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n    },\r\n    rootBox: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        alignItems: \"center\",\r\n        position: \"relative\",\r\n        width: 600,\r\n        opacity: 1,\r\n        zIndex: 2,\r\n        backgroundColor: \"#fff\"\r\n    },\r\n    shutDown: {\r\n        position: \"absolute\",\r\n        top: 5,\r\n        right: 5,\r\n        cursor: \"pointer\"\r\n    },\r\n    media: {\r\n        height: 400,\r\n    },\r\n    mediaBox: {\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        border: \"1px solid #cdcdcd\"\r\n    },\r\n    row: {\r\n        width: 400,\r\n        margin: \"10px 0\"\r\n    },\r\n    buttonBox: {\r\n        height: 50,\r\n        lineHeight: \"50px\"\r\n    },\r\n    cancel: {\r\n        width: 90,\r\n        height: 30,\r\n        border: \"1px solid #cdcdcd\",\r\n        color: \"#808080\",\r\n        borderRadius: 5,\r\n        marginLeft: 30,\r\n        cursor: \"pointer\"\r\n    },\r\n    upload: {\r\n        width: 90,\r\n        height: 30,\r\n        border: 0,\r\n        color: \"#ffffff\",\r\n        borderRadius: 5,\r\n        marginLeft: 30,\r\n        cursor: \"pointer\",\r\n        background: \"rgba(44,195,253,1)\",\r\n    }\r\n});\r\nimport {withStyles} from '@material-ui/core'\r\n\r\nclass UploadFile extends PureComponent {\r\n    state = {\r\n        name: '',\r\n        path: '',\r\n        preview: null,\r\n        data: null,\r\n        time: null\r\n    };\r\n\r\n    setBox = () => {\r\n        this.props.change()\r\n    };\r\n\r\n    changeName = (e) => {\r\n        this.setState({name: e.target.value})\r\n    };\r\n\r\n    //选择文件\r\n    changePath = (e) => {\r\n        const file = e.target.files[0];\r\n        let date = file.lastModifiedDate.toString().split(' ');\r\n        if (!file) {\r\n            return;\r\n        }\r\n        this.setState({time: date});\r\n        let src, preview, type = file.type;\r\n        //规定数据展示\r\n        // 匹配类型为image/开头的字符串\r\n        if (/^image\\/\\S+$/.test(type)) {\r\n            src = URL.createObjectURL(file);\r\n            preview = <img style={box} src={src} alt=''/>\r\n        }\r\n        // 匹配类型为video/开头的字符串\r\n        else if (/^video\\/\\S+$/.test(type)) {\r\n            src = URL.createObjectURL(file);\r\n            preview = <video style={box} src={src} autoPlay loop controls/>\r\n        }\r\n        // 匹配类型为text/开头的字符串\r\n        else if (/^text\\/\\S+$/.test(type)) {\r\n            const self = this;\r\n            const reader = new FileReader();\r\n            reader.readAsText(file);\r\n            //注：onload是异步函数，此处需独立处理\r\n            reader.onload = function (e) {\r\n                preview = <textarea style={box} value={this.result} readOnly></textarea>\r\n                self.setState({path: file.name, data: file, preview: preview})\r\n            };\r\n            return;\r\n        }\r\n        this.setState({path: file.name, data: file, preview: preview})\r\n    };\r\n\r\n    // 上传文件\r\n    upload = () => {\r\n        const data = this.state.data;\r\n        let {name, time} = this.state;\r\n        if (!data || name === '') {\r\n            console.log('未选择文件');\r\n            return;\r\n        }\r\n        console.log(\"上传文件\");\r\n        console.log(this.state.time);\r\n        let month = time[1].toLocaleUpperCase();\r\n        this.props.LocalUpload({id:111111,data:{time: `${time[2]} ${month} ${time[3]}`, name: name}}).then((data) => {\r\n            if (data === 1) {\r\n                alert(\"成功\");\r\n                this.props.change();\r\n            } else {\r\n                alert(\"失败\")\r\n            }\r\n        });\r\n        this.props.addData([{time: `${time[2]} ${month} ${time[3]}`, name: name}]);\r\n        /*//此处的url应该是服务端提供的上传文件api\r\n        const url = 'http://localhost:3000/api/upload';\r\n        const form = new FormData();\r\n\r\n        //此处的file字段由上传的api决定，可以是其它值\r\n        form.append('file', data);\r\n        //服务器路径有问题。\r\n        fetch(url, {\r\n            method: 'POST',\r\n            body: form\r\n        }).then(res => {\r\n            console.log(res)\r\n        })*/\r\n    };\r\n\r\n    render() {\r\n        const {classes} = this.props;\r\n        const {name, path, preview} = this.state;\r\n        return (\r\n            <div className={classes.root}>\r\n                <div className={classes.rootBox}>\r\n                    <div className={classes.shutDown} onClick={this.setBox}>关闭</div>\r\n                    <h4>上传文件</h4>\r\n                    <div className={classes.row}>\r\n                        <input type='text' placeholder='请输入文件名' value={name} onChange={this.changeName}/>\r\n                    </div>\r\n                    <div className={classes.row}>\r\n                        <div className='row-input'>\r\n                            <input type='file' accept='video/*,image/*,text/plain' onChange={this.changePath}/>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className={classes.buttonBox}>\r\n                        <button className={classes.upload} onClick={this.upload}>上传</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default withStyles(styles)(UploadFile)"],"sourceRoot":""}